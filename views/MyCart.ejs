<!DOCTYPE html>
<html>
<title>Imagine Wizards</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Quicksand">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source Serif Pro">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/QuarkStylesDesktop.css">
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
<link rel="stylesheet" href="/QuarksLargePh.css">
<link rel="stylesheet" href="/MyCart.css">

 <meta property="og:url"           content="angshumankashyap.in/QuarkX" />
 <meta property="og:type"          content="website" />
 <meta property="og:title"         content="Get customized Nike shoes in Imagine Wizards"/>
 <meta property="og:description"   content="Craft magic with art" />
 <meta property="og:image"         content="ImagineWizardPhotos/logo2.png" />
<link rel="stylesheet" href="/w3styles.css">
<link rel="stylesheet" href="/AngzPhStyles.css">

<!-- <link rel="icon" href="/ImagineWizardPhotos/logo2.png"> -->

<script src="slickJS/slick.js" type="text/javascript"></script>
<link rel="stylesheet" href= "/slickCss/slick.css">
<link rel="stylesheet" href= "/slickCss/slick-theme.css">

<link rel="stylesheet" href= "/AngzDesktopStyles.css">

<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

<!-- NAV BAR  -->
<link rel="stylesheet" href="/nav.css">
<script src='https://kit.fontawesome.com/a076d05399.js'></script>

<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script src="https://www.w3schools.com/lib/w3.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/jquery.slick/1.5.0/slick.min.js"> </script>

<script src="https://www.w3schools.com/lib/w3.js"></script>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Lora:ital@1&display=swap" rel="stylesheet">


<!-- NEWLY ADDED Google FONT -->
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Alegreya&family=Concert+One&family=Lora:ital,wght@1,400;1,600;1,700&display=swap" rel="stylesheet">

<style>

      .productImages{
          width: 65vw;
      }
        
      .productCards{
        width: 28vw;
        height:28vw;
        margin-top: 0.5vw;
        margin-right: 0.5vw;
      }

      #prodDetailsDiv{
        width:32.5vw;
      }

      #productName{
          font-size: 1.5vw;
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          margin-top: 1vw;
      }

      #brandText{
        font-size: 1vw;
        margin-top:0.5vw
      }

      #ThisProductPrice{
        font-size: 1.5vw;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        margin-top: 1vw;
      }

      #selectSizeText{
        font-size: 1.1vw;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        margin-top: 1.5vw;
      }

      .shoeSize{
          border-radius: 0.5vw;
          text-align: center;
          margin-left: 1vw;
          margin-bottom: 1vw;
          background-color: white;
          border: 2px solid #bbb;
          font-size: 0.75vw;
          width: 4vw;
      }

      #sizesDiv{
          margin-left: -3.9vw;
      }

      #QuantityTxt{
        font-size: 1.1vw;
      }

      #quantityBtn{
        margin-top: -2vw;
        font-size: 1.1vw;
        margin-left: 1vw;
        background-color: white;
      }
    
      #quantityBtn:focus {
         outline: none;
         box-shadow: none;
      }

      #AddCartBtn{
          margin-top: 2vw;
          padding-left: 4.5vw;
          padding-right: 4.5vw;
      }

</style>

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

         <!-- Navbar (sit on top) -->
<body style="width:100vw; min-width: 100vw; max-width: 100vw; overflow-x: hidden; background-color: white;">

  <div class="w3-top">
  <div class="w3-bar w3-white" id="myNavbar" style="box-shadow: 3px 3px 3px #A8A8A8 ; width:100vw; max-width:100vw; min-width:100vw; height: 7vw">
    
    <div style="cursor: pointer;" class="w3-bar-item"> <img id="QuarksLogo" src="/ImagineWizardPhotos/logo2.png"> </div> 
    <div class="w3-bar-item FiltersText"><span id="Filters1">Men</span><span id="Filters2">Women</span><span id="Filters3">Kids</span></div>

    <a style="cursor: pointer;" href="../signup" ><div style="cursor: pointer;" class="w3-bar-item w3-hide-small" id="loginBtn">Log In</div></a>
    <a href="../signup" style="cursor: pointer;"><div style="cursor: pointer;" class="w3-bar-item w3-hide-small" id="signUpBtn">Sign Up</div></a>
  
  <!-- Navbar on small screens -->
</div>
</div>
  

<div id="firstCartDiv">
  <div id="processFlowTxt"><span style="color:#088F8F">MY BAG</span>  ---------------  ADDRESS  ---------------  PAYMENT </div>
  <hr>
</div>

<div id="OrderPlacementDiv">
  <div id="billingDetailsText">Order Summary </div>
  
  <div id="couponSection">
    <div id="couponLine"></div>
    
    <input id="coponCode" placeholder="Have a coupon code? Enter it here.">
    <div onclick="addCoupon()" id="AddCouponBtn">Add </div>
    <div onclick="removeCoupon()" id="remCouponBtn">Remove </div>
  
  </div>

  <div id="billingLine0"> 
    <div id="couponCodeMsg"></div>
  </div>

  <div id="billingLine1"> 
    <span id="cartTotalText"> Cart Total</span>
    <span id="totalOrgAmount"></span>
  </div>

  <div id="billingLine2"> 
    <span class="discountTxt"> Discount</span>
    <span class="discountTxt" id="discountAmt"></span>
  </div>

  <div id="billingLine3"> 
    <span class="deliveryFee">Delivery (Standard Fee)</span>
    <span class="deliveryFee" id="shippingAmt">FREE</span>
  </div>

  <div id="billingLineCoupon"> 
    <span id="couponCode"></span>
    <span id="couponDiscountAmt"></span>
  </div>

  <div id="billingLine4"> 
    <span id="finalAmtText" style="font-weight: 900;">Payable Amount</span>
    <span id="FinalAmt"></span>
  </div>

  <div id="taxMsg">Including AED <span id="TaxAmt"></span> in taxes</div>

  <button class="btn" id="placeOrderBtn">PLACE ORDER </button>


</div>

<div id="cartProdsDiv">
  <ul id="CartProductCardsList" style="list-style-type:none;">
    <% var i=0; %>
    <% for(products of cartProductsDisplay){%>
      <li id="EachCartProd">
        <img onclick="ViewProdBtn('<%=products.CartToProductJoin.PROD_ID%>')" class="CartProductImg"src=<%=products.CartToProductJoin.PROD_IMG1%>>
        <div onclick="ViewProdBtn('<%=products.CartToProductJoin.PROD_ID%>')" id="CartProdTitle"><%=products.CartToProductJoin.PROD_TITLE%><span class="w3-hide">,</span></div>
       
        <div class="w3-hide" id="prodPrice"><%=products.CartToProductJoin.PRICE%><span class="w3-hide">,</span></div>
        <div id="CartProdPriceDisplay">AED <%=products.CartToProductJoin.PRICE%><span class="w3-hide">,</span></div>
       
        <div class="w3-hide" id="originalPrice"><%=products.CartToProductJoin.ORIGINAL_PRICE%><span class="w3-hide">,</span></div>
        <div id="CartProdPriceOrg">AED <%=products.CartToProductJoin.ORIGINAL_PRICE%><span class="w3-hide">,</span></div>

        <!-- prodTitleView, prodDescView, prodThemeView, prodPriceView -->
              <div class="w3-hide" id="cartProdId"><%=products.PROD_ID%><span class="w3-hide">,</span></div>
             
                <div id="sizeDropdown" class="w3-dropdown-hover">
                  <button id="sizeBtn" class="btn btn-primary dropdown-toggle w3-white w3-border-grey" data-toggle="dropdown">Size: <%=products.SIZE%> <span class="caret"></span></button>
                  <div id="sizeOptions" class="w3-dropdown-content w3-bar-block w3-border">
                    <a onclick="sizeChanged('<%=products.SIZE%>', 'XXS','<%=products.PROD_ID%>', '<%=products.QUANTITY%>')" class="w3-bar-item w3-button">XXS<a>
                    <a onclick="sizeChanged('<%=products.SIZE%>','XS','<%=products.PROD_ID%>', '<%=products.QUANTITY%>')" class="w3-bar-item w3-button">XS</a>
                    <a onclick="sizeChanged('<%=products.SIZE%>','S','<%=products.PROD_ID%>', '<%=products.QUANTITY%>')" class="w3-bar-item w3-button">S</a>
                    <a onclick="sizeChanged('<%=products.SIZE%>','M','<%=products.PROD_ID%>', '<%=products.QUANTITY%>')" class="w3-bar-item w3-button">M</a>
                    <a onclick="sizeChanged('<%=products.SIZE%>','L','<%=products.PROD_ID%>', '<%=products.QUANTITY%>')" class="w3-bar-item w3-button">L</a>
                    <a onclick="sizeChanged('<%=products.SIZE%>','XL','<%=products.PROD_ID%>', '<%=products.QUANTITY%>')" class="w3-bar-item w3-button">XL</a>
                    <a onclick="sizeChanged('<%=products.SIZE%>','XXL','<%=products.PROD_ID%>', '<%=products.QUANTITY%>')" class="w3-bar-item w3-button">XXL</a>
                  </div>
                </div>

                <div id="QtyDropdown" class="w3-dropdown-hover">
                  <button id="QtyBtn" class="btn btn-primary dropdown-toggle w3-white w3-border-grey" data-toggle="dropdown">Quantity: <%=products.QUANTITY%> <span class="caret"></span></button>
                  <div id="QtyOptions" class="w3-dropdown-content w3-bar-block w3-border">
                    <a onclick="QtyChanged('<%=products.SIZE%>','<%=products.PROD_ID%>', '<%=products.QUANTITY%>','1')" class="w3-bar-item w3-button">1<a>
                    <a onclick="QtyChanged('<%=products.SIZE%>','<%=products.PROD_ID%>', '<%=products.QUANTITY%>','2')" class="w3-bar-item w3-button">2</a>
                    <a onclick="QtyChanged('<%=products.SIZE%>','<%=products.PROD_ID%>', '<%=products.QUANTITY%>','3')" class="w3-bar-item w3-button">3</a>
                    <a onclick="QtyChanged('<%=products.SIZE%>','<%=products.PROD_ID%>', '<%=products.QUANTITY%>','4')" class="w3-bar-item w3-button">4</a>
                    <a onclick="QtyChanged('<%=products.SIZE%>','<%=products.PROD_ID%>', '<%=products.QUANTITY%>','5')" class="w3-bar-item w3-button">5</a>
                    <a onclick="QtyChanged('<%=products.SIZE%>','<%=products.PROD_ID%>', '<%=products.QUANTITY%>','6')" class="w3-bar-item w3-button">6</a>
                    <a onclick="QtyChanged('<%=products.SIZE%>','<%=products.PROD_ID%>', '<%=products.QUANTITY%>','7')" class="w3-bar-item w3-button">7</a>
                    <a onclick="QtyChanged('<%=products.SIZE%>','<%=products.PROD_ID%>', '<%=products.QUANTITY%>','8')" class="w3-bar-item w3-button">8</a>
                    <a onclick="QtyChanged('<%=products.SIZE%>','<%=products.PROD_ID%>', '<%=products.QUANTITY%>','9')" class="w3-bar-item w3-button">9</a>
                    <a onclick="QtyChanged('<%=products.SIZE%>','<%=products.PROD_ID%>', '<%=products.QUANTITY%>','10')" class="w3-bar-item w3-button">10</a>

                  </div>
                </div>
                <div class="hl"></div>
                <div class="btn btn-primary dropdown-toggle w3-white w3-border-grey" id="RemoveBtn" onclick="removeCartProd('<%=products.PROD_ID%>','<%=products.SIZE%>','<%=products.QUANTITY%>', '<%=products.CartToProductJoin.PROD_IMG1%>')">Remove</div>
      </li>
      <% i++; %>
      <%}%>
    </ul>
  </div>

<!-- The Modal -->
<div id="removeCartModal" class="w3-modal">
  <div id="removeContainer" class="w3-modal-content">
    <div class="w3-container">
      <span id="modalCrossBtn" onclick="document.getElementById('removeCartModal').style.display='none'">&times;</span>
      
      <img id="removedProdImg">
      <div id="removeMsg">Remove Item From Cart</div>
      <div id="removeQsn">Are you sure you want to move this product from your cart?</div>
      <div>
        <hr id="horizontalLineModal">
        <div id="noBtn">MOVE TO WISHLIST</div>
        <div id="yesRemoveBtn">REMOVE</div>
        </div>
      </div>
    </div>
  </div>

  <div style="display:none;" id="emptyCartDiv">
    <img id="emptyCartImg" src="/ImagineWizardPhotos/empty-cart.png">
    <div id="emptyCartTex">Your shopping cart is empty. </div>
    <div id="emptyCTxt1">Please add something soon. Empty carts weave no magic.</div>
    <input class="w3-hide" type="text" id="itemCount" value=<%=itemCount%>>
    <a href="http://localhost:8001"><button id="continueShoppingBtn" class="btn"> CONTINUE SHOPPING </button></a>
  </div>


  <form class="w3-hide" id="UpdateCartSizeForm" action="/QuarkXAcademy/UpdateCartProdSize" method="POST">
    <input type="text"id="updateProdId" name="selectedProdId" placeholder="updateProdId">
    <input type="text"id="NewSize" name="selectedSize" placeholder="NewSize">
    <input type="text"id="oldSize" name="oldSize" placeholder="oldSize">
    <input type="text"id="thisQuantity" name="selectedQuantity" placeholder="thisQuantity">
    <input type="text"id="userTokenSize" name="userToken" placeholder="userToken">

    <button type="submit" class="w3-blue btn btn-default">Submit</button>
  </form>


  <form class="w3-hide" id="UpdateCartQtyForm" action="/QuarkXAcademy/UpdateCartProdQty" method="POST">
    <input type="text"id="thisProdId" name="selectedProdId" placeholder="selectedProdId">
    <input type="text"id="thisProdSize" name="selectedSize" placeholder="selectedSize">
    <input type="text"id="NewProdQty" name="selectedQuantity" placeholder="NewProdQty">
    <input type="text"id="OldProdQty" name="OldProdQty" placeholder="OldProdQty">
    <input type="text"id="userToken" name="userToken" placeholder="userToken">
    
    <button type="submit" class="w3-blue btn btn-default">Submit</button>
  </form>

  <form class="w3-hide" id="RemoveCartProdForm" action="/QuarkXAcademy/RemoveCartProd" method="POST">
    <input type="text"id="RemoveProdId" name="selectedProdId" placeholder="RemoveProdId">
    <input type="text"id="RemoveProdSize" name="selectedSize" placeholder="RemoveProdSize">
    <input type="text"id="RemoveProdQty" name="selectedQuantity" placeholder="RemoveProdQty">
  
    <button type="submit" class="w3-blue btn btn-default">Submit</button>
  </form>

  <form class="w3-hide" id="ViewProductForm" action="/QuarkXAcademy/ProductInfo" method="POST">
    <input type="text"id="productIdView" name="productId" placeholder="productIdView">
    <input type="text"id="prodTitleView" name="productTitle" placeholder="prodTitleView">
    <input type="text"id="prodDescView" name="productDesc" placeholder="prodDescView">
    <input type="text"id="prodThemeView" name="productTheme" placeholder="prodThemeView">
    <input type="text"id="prodPriceView" name="productPrice" placeholder="prodPriceView">

    <button type="submit" class="w3-blue btn btn-default">Submit</button>
  </form>

  <input id="priceNoCoupon" class="w3-hide">
  <input id="taxNoCoupon" class="w3-hide">

        

<!-- new add to cart try -->
<ul id="myUl">

</ul>

        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-157972185-1">
        </script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'UA-157972185-1');
        </script>
        
        <script>
            AOS.init();
          </script>
      
      
<script>
   if(document.getElementById('itemCount').value == 0) {
    $("#emptyCartDiv").show();
    $("#OrderPlacementDiv").hide();
   }
</script>

<script>    //Refresh page on back/forward button
  window.addEventListener( "pageshow", function ( event ) {
   var historyTraversal = event.persisted || 
                          ( typeof window.performance != "undefined" && 
                               window.performance.navigation.type === 2 );
   if ( historyTraversal ) {
     // Handle page restore.
     if(userToken){
      userToken1=userToken;
    }
    else{
      userToken1=Date.now();
      localStorage.setItem("Token",userToken1);
    }
    hrefStr = "http://localhost:8001/QuarkXAcademy/ViewCart" + "/" + userToken1; 
    location.href = hrefStr;
   }
 });
 </script>

<script>
  var userToken = localStorage.getItem("Token");
  if(userToken){
    userToken1=userToken;
  }
  else{
    userToken1=Date.now();
    localStorage.setItem("Token",userToken1);
  }

  var currentUrl = document.URL
  var urlToken = currentUrl.substring(currentUrl.length-13, currentUrl.length);
// console.log(urlToken)

  if(urlToken!=userToken1){
    hrefStr = "http://localhost:8001/QuarkXAcademy/ViewCart" + "/" + userToken1; 
    location.href = hrefStr;
  }
</script>


<script>
            // var FromAddCart = document.getElementById('FromAddCart').value;

            // if(FromAddCart=='yes'){ //call get page to not call AddToCart Post api upon reloading 
            //     var xhr = new XMLHttpRequest();
            //     xhr.open("GET", "http://localhost:8001/QuarkxAcademy/UpdateCartProdSize", true);
            //     xhr.onload = (e) => {
            //           if (xhr.readyState === 4) {
            //             if (xhr.status === 200) {
            //                 location.replace("http://localhost:8001/QuarkxAcademy/UpdateCartProdSize");
            //             } else {
            //               console.error(xhr.statusText);
            //             }
            //           }
            //         };
            //         xhr.onerror = (e) => {
            //           console.error(xhr.statusText);
            //         };
            //         xhr.send(null);
            //   }

    function sizeChanged(OldSize, ProdSize, ProdId, ProdQty) {     

              var userToken = localStorage.getItem("Token");
                      if(userToken){
                        userToken1=userToken;
                      }
                      else{
                        userToken1=Date.now();
                        localStorage.setItem("Token",userToken1);
                      }

              if(OldSize!=ProdSize) {
                  var url = 'http://localhost:8001/QuarkxAcademy/UpdateCartProdSize';
                  var params = {
                    selectedProdId: ProdId,
                    selectedSize: ProdSize,
                    oldSize: OldSize,
                    selectedQuantity: ProdQty,
                    userToken: userToken1
                  };
                  var xmlHttp = new XMLHttpRequest();
                  xmlHttp.onreadystatechange = function (res) {
                
                  if (xmlHttp.readyState === 4) {
                    res=JSON.parse(xmlHttp.responseText);

                    if(res.status=="success"){
                      var userToken = localStorage.getItem("Token");
                      if(userToken){
                        userToken1=userToken;
                      }
                      else{
                        userToken1=Date.now();
                        localStorage.setItem("Token",userToken1);
                      }
                      hrefStr = "http://localhost:8001/QuarkXAcademy/ViewCart" + "/" + userToken1;
                      location.href = hrefStr;     
                    }
      
                  }
              }
                  xmlHttp.open("POST", url, true); // false for synchronous request
                  xmlHttp.withCredentials = true;
                  xmlHttp.setRequestHeader("Content-type", "application/json");
                  xmlHttp.send(JSON.stringify(params));
              }
    }
</script>

<script>

    function QtyChanged(ProdSize, ProdId, OldProdQty, NewProdQty) {

            var userToken = localStorage.getItem("Token");
            if(userToken){
              userToken1=userToken;
            }
            else{
              userToken1=Date.now();
              localStorage.setItem("Token",userToken1);
            }
 
            //stop this trigger
            if(OldProdQty!=NewProdQty){
              var url = 'http://localhost:8001/QuarkxAcademy/UpdateCartProdQty';
                  var params = {
                    selectedProdId: ProdId,
                    selectedSize: ProdSize,
                    selectedQuantity: NewProdQty,
                    userToken: userToken1
                  };
                  var xmlHttp = new XMLHttpRequest();
                  xmlHttp.onreadystatechange = function (res) {
                
                  if (xmlHttp.readyState === 4) {
                    res=JSON.parse(xmlHttp.responseText);

                    if(res.status=="success"){
                      var userToken = localStorage.getItem("Token");
                      if(userToken){
                        userToken1=userToken;
                      }
                      else{
                        userToken1=Date.now();
                        localStorage.setItem("Token",userToken1);
                      }
                      hrefStr = "http://localhost:8001/QuarkXAcademy/ViewCart" + "/" + userToken1;
                      location.href = hrefStr;     
                    }
      
                  }
              }
                  xmlHttp.open("POST", url, true); // false for synchronous request
                  xmlHttp.withCredentials = true;
                  xmlHttp.setRequestHeader("Content-type", "application/json");
                  xmlHttp.send(JSON.stringify(params));
    }
}
</script>

<script>

  function removeCartProd(RemoveProdId, RemoveProdSize, RemoveProdQty, RemoveProdImg) {

          //for confirmation
          document.getElementById('removeCartModal').style.display='block'
          document.getElementById("removedProdImg").src = RemoveProdImg

          var userToken = localStorage.getItem("Token");
          if(userToken){
            userToken1=userToken;
          }
          else{
            userToken1=Date.now();
            localStorage.setItem("Token",userToken1);
          }

          $("#yesRemoveBtn").click(function(){
            
            var url = 'http://localhost:8001/QuarkxAcademy/RemoveCartProdNew';
              var params = {
                selectedProdId: RemoveProdId,
                selectedSize: RemoveProdSize,
                selectedQuantity: RemoveProdQty,
                userToken: userToken1,
                wishlist:"No"
              };
              var xmlHttp = new XMLHttpRequest();
              xmlHttp.onreadystatechange = function (res) {
            
              if (xmlHttp.readyState === 4) {
                res=JSON.parse(xmlHttp.responseText);

                if(res.status=="success"){
                  var userToken = localStorage.getItem("Token");
                  if(userToken){
                    userToken1=userToken;
                  }
                  else{
                    userToken1=Date.now();
                    localStorage.setItem("Token",userToken1);
                  }
                  hrefStr = "http://localhost:8001/QuarkXAcademy/ViewCart" + "/" + userToken1;
                  location.href = hrefStr;     
                }
  
              }
          }
              xmlHttp.open("POST", url, true); // false for synchronous request
              xmlHttp.withCredentials = true;
              xmlHttp.setRequestHeader("Content-type", "application/json");
              xmlHttp.send(JSON.stringify(params));
        
      });


          $("#noBtn").click(function(){
            
                var url = 'http://localhost:8001/QuarkxAcademy/RemoveCartProdNew';
                  var params = {
                    selectedProdId: RemoveProdId,
                    selectedSize: RemoveProdSize,
                    selectedQuantity: RemoveProdQty,
                    userToken: userToken1,
                    wishlist:"yes"
                  };
                  var xmlHttp = new XMLHttpRequest();
                  xmlHttp.onreadystatechange = function (res) {
                
                  if (xmlHttp.readyState === 4) {
                    res=JSON.parse(xmlHttp.responseText);

                    if(res.status=="success"){
                      var userToken = localStorage.getItem("Token");
                      if(userToken){
                        userToken1=userToken;
                      }
                      else{
                        userToken1=Date.now();
                        localStorage.setItem("Token",userToken1);
                      }
                      hrefStr = "http://localhost:8001/QuarkXAcademy/ViewCart" + "/" + userToken1;
                      location.href = hrefStr;     
                    }
      
                  }
              }
                  xmlHttp.open("POST", url, true); // false for synchronous request
                  xmlHttp.withCredentials = true;
                  xmlHttp.setRequestHeader("Content-type", "application/json");
                  xmlHttp.send(JSON.stringify(params));
            
          });

          
          

          // hrefStr = "http://localhost:8001/QuarkXAcademy/RemoveCartProd" + "/" + RemoveProdId + "/" + RemoveProdSize + "/" + RemoveProdQty;

          // location.href = hrefStr;
}
</script>

<!-- <script>  //not working
 $("#CartProductCardsList li #RemoveBtn").click(function() {
          var index = $("#CartProductCardsList li").index();
          $("this").hide();
        });
</script> -->

<!-- <script>  // unable to do
        let cartArray = window.localStorage.getItem("cart");
        if(cartArray){
          cartArray=JSON.parse(cartArray);
        }
        else{
          cartArray=[];
        }

        cartArray.forEach(function(item) {
          var myCartList = document.createElement("li");
          var prodCartIdDiv = document.createElement("div");
         
          prodCartIdDiv.setAttribute("id", "prodCartIdNew");

          var prodCartIdText = document.createTextNode(item.prodId);

          prodCartIdDiv.appendChild(prodCartIdText);

          // prodCartIdNew = document.createTextNode(item.prodId);

          
          myCartList.appendChild(prodCartIdDiv);


          // prodCartIdNew = document.createTextNode(item.prodId);
          
          // myCartList.append(prodCartIdNew);
       



        // var prodId = document.createTextNode(item.prodId);
        // var cartQty = document.createTextNode(item.quantity);
        // var cartProdSize = document.createTextNode(item.size);

        
        // li.appendChild(prodId);
        // li.appendChild(cartQty);
        // li.appendChild(cartProdSize);





         document.getElementById("myUl").appendChild(myCartList);
      });

        console.log("The new cart items are these from local storage", cartArray)
</script>
 -->

<script>
  function ViewProdBtn(productIdView) {

          var userToken = localStorage.getItem("Token");
          if(userToken){
            userToken1=userToken;
          }
          else{
            userToken1=Date.now();
            localStorage.setItem("Token",userToken1);
          }

            document.getElementById('productIdView').value = productIdView;
            hrefStr = "http://localhost:8001/QuarkXAcademy/ProductInfo" + "/" + productIdView + "/" + userToken1;
            location.href = hrefStr;
          }
</script>


<script>
  function removeCoupon() {
    document.getElementById("FinalAmt").innerHTML =  document.getElementById('priceNoCoupon').value;
    $("#AddCouponBtn").show()
    $("#remCouponBtn").hide()
    $("#billingLineCoupon").hide()
    document.getElementById("coponCode").value = ""
    $("#couponCodeMsg").hide()

    document.getElementById('TaxAmt').innerHTML = document.getElementById('taxNoCoupon').value;
  }
  </script>


<script>
  function addCoupon() {
    
    var couponCodeEntered = document.getElementById("coponCode").value;
    var userToken = localStorage.getItem("Token");
    if(userToken){
      userToken1=userToken;
    }
    else{
      userToken1=Date.now();
      localStorage.setItem("Token",userToken1);
    }

    if(couponCodeEntered.length>0) {
      console.log("coupon code entered");
      var url = 'http://localhost:8001/QuarkxAcademy/AddCoupon/userToken1';
        var params = {
          couponCode: couponCodeEntered.toUpperCase(),
          userToken: userToken1
        };
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.onreadystatechange = function (res) {
            if (xmlHttp.readyState === 4) {
                res=JSON.parse(xmlHttp.responseText);
                  
                if(res.status=="failure1"){
                 $("#couponCodeMsg").css("color", "red")
                 document.getElementById("couponCodeMsg").innerHTML = "Invalid Coupon Code."
                 $("#billingLineCoupon").hide()
                }
                else if(res.status=="EXPIRED"){  
                 $("#couponCodeMsg").css("color", "red")
                 document.getElementById("couponCodeMsg").innerHTML = "Coupon Code expired."
                 $("#billingLineCoupon").hide()
                }
                else if(res.status=="failure2"){  
                  $("#couponCodeMsg").css("color", "red")
                  document.getElementById("couponCodeMsg").innerHTML = res.message
                  $("#billingLineCoupon").hide()
                }
                else if(res.status=="success"){  
                  $("#couponCodeMsg").css("color", "green")
                  document.getElementById("couponCodeMsg").innerHTML = "Discount Coupon applied."
                  document.getElementById("couponCode").innerHTML = "Discount " + "(" + document.getElementById("coponCode").value.toUpperCase() + ")"
                
                  res.couponDiscount = (Math.round(res.couponDiscount * 100) / 100).toFixed(2);
                  document.getElementById("couponDiscountAmt").innerHTML = res.couponDiscount;

                  res.PayableFinalAmount = (Math.round(res.PayableFinalAmount * 100) / 100).toFixed(2);
                  document.getElementById("FinalAmt").innerHTML = res.PayableFinalAmount

                  var newTax = res.PayableFinalAmount - res.PayableFinalAmount/1.05 
                  newTax = (Math.round(newTax * 100) / 100).toFixed(2);
                  document.getElementById('TaxAmt').innerHTML = newTax
                  
                  $("#billingLineCoupon").show()
                  $("#AddCouponBtn").hide()
                  $("#remCouponBtn").show()
                }
            }
        }
        xmlHttp.open("POST", url, true); // false for synchronous request
        // xmlHttp.withCredentials = true;
        xmlHttp.setRequestHeader("Content-type", "application/json");
        xmlHttp.send(JSON.stringify(params));

    }

   }
    </script>

<script>  
    $(document).ready(function() {
      
        var prodsPrice =  $("#CartProductCardsList li #prodPrice").text();
        var resPrice = prodsPrice.split(",");
        for (var k = 0; k<resPrice.length-1;k++) {
          resPrice[k] = parseInt(resPrice[k])
        }
        // console.log("Selling Price",resPrice);


        var originalPrice =  $("#CartProductCardsList li #originalPrice").text();
        var resOrgPrice = originalPrice.split(",")       
        for (var k = 0; k<resOrgPrice.length-1;k++) {
          resOrgPrice[k] = parseInt(resOrgPrice[k])
        }
        // console.log("Original price",resOrgPrice);


        var prodsQty =  $("#CartProductCardsList li #QtyBtn").text();
        var resQty= prodsQty.split(" ");
        // console.log(resQty);

        var k = 0;
        var totalAmount = 0;
        for (var i = 1; i < resQty.length-1; i=i+2) {
            totalAmount = totalAmount + resPrice[k]* parseInt(resQty[i]);
            k++;
          }
          
          totalAmount = (Math.round(totalAmount * 100) / 100).toFixed(2);

        var p = 0;
        var totalOrgAmount = 0;
        for (var i = 1; i < resQty.length-1; i=i+2) {
            totalOrgAmount = totalOrgAmount + resOrgPrice[p]* parseInt(resQty[i]);
            p++;
          }
          
          totalOrgAmount = (Math.round(totalOrgAmount * 100) / 100).toFixed(2);


          console.log("totalOrgAmount",totalOrgAmount);

          var discount = totalOrgAmount - totalAmount;
          discount = (Math.round(discount * 100) / 100).toFixed(2);
          
          document.getElementById('totalOrgAmount').innerHTML = "AED " + totalOrgAmount;
          document.getElementById('discountAmt').innerHTML = "AED " + discount;

          var FinalAmt = totalOrgAmount - discount;
          FinalAmt = (Math.round(FinalAmt * 100) / 100).toFixed(2);
          document.getElementById('FinalAmt').innerHTML = "AED " + FinalAmt;
          document.getElementById('priceNoCoupon').value = "AED " + FinalAmt; //storing the value in an input to reset price if coupon is removed

          var tax = totalAmount - (totalAmount/1.05);
          tax = (Math.round(tax * 100) / 100).toFixed(2);

          document.getElementById('TaxAmt').innerHTML = tax;
          document.getElementById('taxNoCoupon').value = "AED " + tax;
          

        $("#ProductCardsDiv li").click(function() {
          
          var index = $(this).index();
       
          for (var i = 0; i < res1.length; i++) {
            var prodIdNew = res1[index];
          }

          for (var i = 0; i < res6.length; i++) {
            var prodTitleNew = res6[index];
          }

          for (var i = 0; i < res7.length; i++) {
            var prodDescNew = res7[index];
          }

          for (var i = 0; i < res8.length; i++) {
            var prodThemeNew = res8[index];
          }
          
          for (var i = 0; i < res9.length; i++) {
            var prodPriceNew = res9[index];
          }
          
          document.getElementById('productId').value = prodIdNew;





          document.getElementById('productTitle').value = prodTitleNew;
          document.getElementById('productDesc').value = prodDescNew;
          document.getElementById('productTheme').value = prodThemeNew;
          document.getElementById('productPrice').value = prodPriceNew;

         $("#ViewProductForm").submit();
        });
    });
</script>

</body>
</html>